This is some code edited by dboreham
I made a change here
and another change here
I made a new change here 
