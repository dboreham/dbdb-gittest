Some code added by dboreham2
